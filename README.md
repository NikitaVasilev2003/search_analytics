# Описание работы программы

## Краткое описание

Эта программа помогает анализировать позиции доменов в поисковой выдаче Яндекса по заданным запросам. С её помощью можно быстро получить данные о том, на каких позициях находятся интересующие домены по различным запросам.

---

## Входные данные

Для работы программы необходимо подготовить несколько файлов с исходными данными. Программа уже запускалась на примерах, которые можно найти в папке `search_analyser/data`.

### Что нужно на входе:

1. Файл со списком доменов (например, путь **search_analyser/data/domains.txt**)
   Этот файл содержит список доменов, позиции которых нужно проверить. Каждый домен указывается с новой строки.

2. Файл со списком запросов (например, путь **search_analyser/data/requests.txt**)
   Файл с запросами, которые нужно проанализировать. Запросы также записываются по одному в строку.

3. Клиентский токен Yandex API и идентификатор каталога
    Эти данные требуются для доступа к API Яндекса.

### Настраиваемые параметры:

1. **Регион поиска** (optional)
   Можно указать регион, в котором будет выполняться анализ. Это задаётся с помощью кода региона, например, 213 для Москвы. Полный список регионов доступен [здесь](https://yandex.cloud/ru/docs/search-api/reference/regions). По умолчанию используется код региона "Россия".

2. **Глубина выдачи** (optional)
   Определяет количество позиций, анализируемых в поисковой выдаче (например, ТОП-10 или ТОП-50). Значение по умолчанию — 10.

---

## Как работает программа

1. **Загрузка входных данных**
    Загрузите файлы с доменами и запросами. Укажите их пути при запуске программы вместе с клиентским токеном Yandex API и идентификатором каталога.
2. **Запуск программы**
    Используйте следующую команду для запуска:

    ```bash
    python domain_analytics.__main__ -k <api key> -f <folder id>  -d <path to domains file> -q <path to queries file> -o <path to output file> -r <region identifier> -t <depth>
    ```

    Для получения справки по параметрам используйте:

    ```bash
    python domain_analytics.__main__ --help
    ```

3. **Обработка данных**
    Программа отправляет запросы в Yandex API, получает результаты и обрабатывает их.
4. **Сохранение результатов**
    Обработанные данные сохраняются в CSV-файл, путь к которому указывается в параметрах. Например, по пути **search_analyser/data/output.csv**.

### Пример использования

Программа запускалась на `947` запросах, было проанализировано `8` доменов. Используемый регион — `Россия`, глубина выдачи — `10`. Исходные данные и результаты можно найти в папке **search_analyser/data**.

---

## Выходные данные

Результатом работы программы является CSV-файл с таблицей, содержащей позиции доменов по каждому запросу. Формат данных:

| Запрос            | vk.com | m.vk.com | rutube.ru | dzen.ru |
|--------------------|--------|----------|-----------|---------|
| пример запроса 1  |    1   |     2    |     -     |    5    |
| пример запроса 2  |    -   |     -    |     3     |    8    |

- **Строки**: это запросы, которые вы указали.
- **Столбцы**: это домены из вашего списка.
- **Ячейки**: это позиции доменов в поисковой выдаче.

---

## Возможные проблемы

1. **API не отвечает или возвращает ошибку**
   Проверьте ваш `auth.txt` — возможно, указан неверный токен или идентификатор каталога.

2. **Лимиты запросов превышены**
   Лимиты API составляют 50 копеек за запрос. Убедитесь, что у вас достаточно средств на аккаунте. Также убедитесь, что не превышен суточный лимит запросов, настраиваемый в вашем аккаунте.

---

## Возможности для улучшения

1. **Покрытие тестами**
   Если планируется длительное использование программы, её стоит покрыть тестами. Это поможет быстрее находить и исправлять возможные ошибки.

2. **Автоматизация**
    Реализация автоматического запуска анализа с помощью планировщика задач (например, cron), чтобы получать свежие данные ежедневно.

3. **Визуализация результатов**
    Создание графиков и диаграмм на основе полученных данных для упрощения их анализа.

4. **Интерфейс пользователя**
    Замена работы с текстовыми файлами на веб-интерфейс, позволяющий загружать данные через формы и просматривать результаты в браузере.
